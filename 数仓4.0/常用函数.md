# get_json_object
-- get_json_object测试
-- 1.调用json数组的某个对象
select get_json_object(line,'$.[0].common')
from ods_log

-- 2.调用json对象的某个属性或对象
select get_json_object(line,'$.common.ba')
from ods_log

# date_add
-- 1.指定日期加减一天
select date_add("2020-06-15",1);
select date_add("2020-06-15",-1);

# date_format
select date_format("2020-06-10 22:39:20.0","yyyy-MM-dd")  -->2020-06-10

# coalesce 返回第一个非空的值
select coalesce(null,null,3,......)

# nvl 如果a为null则返回b,如果a不为null则返回a
nvl(a,b)

# case when

case
    when 条件1 then 执行语句1
    when 条件2 then 执行语句2
    when 条件3 then 执行语句3
    else 都不满足执行语句4
end 别名

示例:
select
    case
        when 1>0 then "ok"
        else "no"
    end status


# concat 指定分隔符合并列
concat(id,",",name)

# collection_list/set  把列合并成数组
select id,collect_list(concat("hello",",",name)) name2
from student
group by id

可以配合分组做多行转列


# concat_ws(",",list) 指定分隔符,分割数组的内容

# str_to_map 将字符串转成map
例子:1001=2020-06-12 22:43:56.0,1002=2020-06-12 22:43:57.0
str_to_map(字符串参数,分隔符1,分隔符2)
分隔符1分隔每个k-v对
分隔符2分隔每个k-v对的 k和v

结果:{"1001":"2020-06-12 22:43:56.0","1002":"2020-06-12 22:43:57.0"}


# linux date+%F
返回格式化日期yyyy-MM-dd
# linux date+%s
返回秒级时间戳