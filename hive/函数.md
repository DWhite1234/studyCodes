# 1.NVL(value,default_value)
当value为null时,返回默认值
# 2. CASE WHEN THEN ELSE END(基本不用,if可以替代)
case sex when '男' then 1 else 0 end
# 3.行转列
<!-- 将列拼接显示 -->
1.CONCAT(string A/col, string B/col…)
select concat(constellation,",",blood_type) from person_info;

2.CONCAT_WS(separator(分隔符), str1, str2,...)
select concat_ws(",",constellation,blood_type)from person_info
<!-- 下面两个只接受基本数据类型 -->
3.COLLECT_SET(col),去重集合
select collect_set(t.name)
from (select concat_ws(",",constellation,blood_type) name from person_info)t

4.COLLECT_LIST(col),不去重集合
select collect_list(t.name)
from (select concat_ws(",",constellation,blood_type) name from person_info)t

# 4.列转行
1.Split(str, separator)分割字符串成 集合类型
2.EXPLODE(col)将集合类型拆分为多行
3.LATERAL VIEW
select movie,cate from movie_info
LATERAL VIEW  explode(split(category,",")) tmp as cate ;
